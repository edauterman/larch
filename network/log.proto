syntax = "proto3";

option java_package = "ex.grpc";

// Defines the service
service Log {
    // Function invoked to send the request
    rpc SendInit (InitRequest) returns (InitResponse) {}
    rpc SendReg (RegRequest) returns (RegResponse) {}
    rpc SendAuth (AuthRequest) returns (AuthResponse) {}
}

message HintMsg {
    bytes r = 1;
    bytes g_r = 2;
    bytes a = 3;
    bytes b = 4;
    bytes c = 5;
}

message InitRequest {
    bytes key_comm = 1;
    repeated HintMsg hints = 2;
}

message InitResponse {
    bytes pk = 1;
}

message RegRequest {
}

message RegResponse {
    bytes pk_x = 1;
    bytes pk_y = 2;
}

message AuthRequest {
    bytes proof = 1;
    bytes challenge = 2;
    bytes ct = 3;
    bytes iv = 4;
    bytes digest = 5;
    bytes d = 6;
    bytes e = 7;
}

message AuthResponse {
    bytes prod = 1;
    bytes d = 2;
    bytes e = 3;
}
